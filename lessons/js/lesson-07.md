# 🧩 درس ۷ — اتصال جاوااسکریپت به HTML با `<script>`

## ایدهٔ کلیدی

برای اینکه مرورگر بفهمد «کجاست و کی» باید کد JS را اجرا کند، از تگ جادویی `<script>` استفاده می‌کنیم.

## راه‌های اتصال

1. **کد درون‌خطی (inline):**

```html
<script>
  console.log('سلام از داخل HTML!');
</script>
```

2. **فایل خارجی (پیشنهادی):**

```html
<script src="scripts/app.js"></script>
```

کدتان تمیزتر می‌شود، کش مرورگر بهتر کار می‌کند، و نگه‌داری پروژه آسان‌تر است.

## زمان‌بندی اجرا: `async` vs `defer`

* **بدون هیچ صفتی (کلاسیک):** مرورگر هنگام رسیدن به `<script src="...">`، **پارْس HTML را متوقف می‌کند**، فایل را می‌آورد و همان‌جا اجرا می‌کند؛ بعد ادامهٔ HTML.
* **`async`:** فایل JS همزمان با پارس HTML **دانلود** می‌شود؛ **هر وقت دانلود تمام شد همان لحظه اجرا می‌شود** (ممکن است وسط پارس اجرا شود). **ترتیب بین چند اسکریپت async تضمین نیست.**
* **`defer`:** فایل JS همزمان دانلود می‌شود، **اما اجرا وقتی است که پارسِ کل HTML تمام شد**. **ترتیب بین چند اسکریپت defer حفظ می‌شود** و قبل از رویداد `DOMContentLoaded` اجرا می‌گردد. برای کدی که به DOM نیاز دارد، معمولا بهترین انتخاب است.

> نکتهٔ جای‌گذاری: امروزه قراردادن
>
> ```html
> <script src="scripts/app.js" defer></script>
> ```
>
> در `<head>` یا انتهای `<body>` هردو خوب است؛ `defer` خیال‌تان را از آماده‌بودن DOM راحت می‌کند.

## نمونهٔ کامل

**index.html**

```html
<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="utf-8" />
  <title>صفحه فعال‌شده</title>
  <script src="scripts/rules.js" defer></script>
</head>
<body>
  <h1>صفحهٔ بازی من</h1>
  <p id="message">منتظر جادوی جاوااسکریپت...</p>
</body>
</html>
```

**scripts/rules.js**

```javascript
document.getElementById('message').textContent = 'قوانین بازی بارگذاری شد! 🎯';
```

## نکات طلایی

* **DOM لازم داری؟** `defer` بزن.
* **بارگیری موازی ولی اجرای زودهنگام می‌خواهی و به DOM وابسته نیستی؟** `async`.
* **`charset` روی `<script>`** عملاً کم‌مصرف است؛ UTF-8 را با `<meta charset="utf-8">` مشخص کن.
* **پیشرفته (اختیاری):** اگر از **ماژول‌ها** استفاده می‌کنی:

  ```html
  <script type="module" src="main.js"></script>
  ```

  اسکریپت‌ها به‌صورت پیش‌فرض مثل `defer` رفتار می‌کنند، `import/export` داری، و حوزهٔ سراسری را آلوده نمی‌کنی.

---

## تمرین سریع

1. فایلی به نام `day7.html` بساز.
2. پوشه‌ای به نام `scripts/` و داخلش `my_app.js`.
3. در `day7.html`، این خط را اضافه کن:

```html
<script src="scripts/my_app.js" defer></script>
```

4. در `my_app.js` بنویس:

```javascript
console.log('day7 آماده است!');
```

صفحه را در مرورگر باز کن و کنسول را ببین.

---

## آزمون کوچک

1. برای وارد کردن JS از چه تگی استفاده می‌کنیم؟
2. کدام صفت مسیر فایل JS را مشخص می‌کند؟
3. کدام صفت اجرای JS را تا پایان پارس HTML عقب می‌اندازد؟
4. اگر کد به دکمه‌های صفحه دسترسی می‌خواهد، `defer` بهتر است یا هیچ‌کدام؟
5. `async` چه می‌کند؟
6. کدام یک «هنگام **اجرای** JS» پارس HTML را متوقف می‌کند: `async` یا `defer`؟
7. چرا فایل خارجی بهتر از کد inline است؟
8. اگر کد را داخل `<script> ... </script>` بنویسیم، آیا به `src` نیاز داریم؟
9. آیا با `defer`، پارس HTML بعد از دانلود JS متوقف می‌شود؟
10. کاربرد `charset` روی `<script>` چیست؟
11. آیا می‌توان `defer` را همراه با `src` استفاده کرد؟
12. اسکریپت با فقط `src` (بدون `async/defer`) چه اثری روی پارس دارد؟
13. برای دانلود نامتقارن از کدام صفت استفاده می‌کنیم؟
14. چرا دسترسی زودهنگام به DOM مشکل‌زا است؟
15. چند صفت رایج و مهم برای `<script>` نام ببر.

**پاسخ‌های کوتاه:**

1. `<script>`  2) `src`  3) `defer`  4) `defer`
2. دانلود موازی، اجرای زودهنگام پس از اتمام دانلود (بدون تضمین ترتیب)
3. هر دو هنگام **اجرای** JS پارس را متوقف می‌کنند؛ فرقشان زمانِ اجراست (async فوراً، defer بعد از پارس)
4. تمیزی، کش بهتر، نگه‌داری آسان  8) خیر
5. نه؛ اجرا عقب می‌افتد تا بعد از پارس  10) تعیین کدگذاری؛ نادر است، UTF-8 را با `<meta>` بزن
6. بله (الگوی پیشنهادی)  12) پارس را برای دانلود و اجرا متوقف می‌کند
7. `async`  14) چون عنصر هنوز ساخته/پارس نشده است
8. `src`, `defer`, `async`, (اختیاری: `type`، مثل `module`)

---

🌟 **پیام پایانی:**
تو امروز «کلید روشن کردن» جاوااسکریپت روی صفحه را یاد گرفتی. از اینجا به بعد، هر دکمه و هر انیمیشن در کنترل توست. یک قدم دیگر به فول‌استک واقعی نزدیک شدی! 🚀
