
---

# 🎓 درس ۸ — مدیریت خطا (Error Handling) در JavaScript

---

## 🎯 هدف درس

یاد بگیری چطور وقتی در برنامه‌ات مشکلی پیش میاد، مثل یک **برق‌کار حرفه‌ای** فیوز درست کار کنه ⚡

تا کل سیستم نسوزه 😅

📌 در جاوااسکریپت، خطاها باعث توقف اجرای برنامه می‌شن،

اما با `try...catch` می‌تونی خطاها رو بگیری، بررسی کنی، و به کاربر پیام مناسب بدی.

---

## 🧩 بخش ۱ — انواع خطاها در جاوااسکریپت

✨ خطاها (Errors) معمولاً سه نوع اصلی دارن:

| نوع خطا        | نام                              | توضیح کوتاه |
| -------------- | -------------------------------- | ----------- |
| ReferenceError | استفاده از متغیر تعریف‌نشده      |             |
| SyntaxError    | رعایت نکردن قواعد زبان           |             |
| TypeError      | اجرای متد نامعتبر روی نوع اشتباه |             |

---

### 1️⃣ ReferenceError — ارجاع به متغیر تعریف‌نشده ❗

📘 وقتی متغیری قبل از تعریف استفاده می‌کنی:

```js
let result;
result = 5 + 2;
console.log(sum); // ❗ sum تعریف نشده
```

🎯 خطا: `ReferenceError: sum is not defined`

🧠 مثال واقعی:

مثل صدا زدن دوستی که توی اتاق نیست:

> "علیییی..." (اما علی اونجا نیست 😅)

✅ تمرین:

```js
try {
  console.log(x); // ❌ هنوز تعریف نشده
} catch (e) {
  console.log("Error:", e.name);
}
```

---

### 2️⃣ SyntaxError — خطای نحوی 🧩

📘 وقتی قوانین جاوااسکریپت رعایت نشه (مثلاً پرانتز جا بمونه):

```js
if 5<10 {
    console.log("object");
} 
```

🎯 خطا: `SyntaxError: Unexpected number`

🧠 مثال واقعی:

مثل گفتن جمله بدون فعل:

> "من امروز مدرسه..." (بقیه جمله کو؟ 😅)

✅ تمرین (درستش):

```js
if (5 < 10) {
  console.log("object");
}
```

---

### 3️⃣ TypeError — نوع داده اشتباه 🧠

📘 وقتی متدی رو روی مقداری صدا بزنی که اون متد رو نداره:

```js
null.sayhello(); // ❌ null هیچ متدی نداره
```

🎯 خطا: `TypeError: Cannot read properties of null`

🧠 مثال واقعی:

مثل تلاش برای باز کردن درِ دیوار 😅

✅ تمرین:

```js
let x = null;
try {
  x.toUpperCase();
} catch (e) {
  console.log(e.name, "→", "You can't call a method on null!");
}
```

---

## 🧩 بخش ۲ — مدیریت خطا با try...catch 🎯

📘 ساختار کلی:

```js
try {
  // کدهای خطرناک
} catch (e) {
  // وقتی خطا رخ داد، اینجا اجرا می‌شود
}
```

📖 مثال واقعی:
مثل **کمربند ایمنی ماشین 🚗**؛

اگر تصادف بشه، فیوز (catch) عمل می‌کنه تا آسیبی به کل سیستم نرسه.

---

### 🔹 نسخه ۱ — پیام ثابت برای همهٔ خطاها

📘 ساده‌ترین حالت:

```js
try {
  let result;
  result = 5 + 2;
  console.log(sum); // ❌ ReferenceError
} catch (e) {
  console.log("try again");
}
```

🎯 نتیجه: فقط پیام ثابت `"try again"` نمایش داده می‌شود.

🔸 ولی نوع خطا را نمی‌فهمیم!

✅ تمرین:

```js
try {
  console.log(a + 10);
} catch (e) {
  console.log("Something went wrong!");
}
```

---

### 🔹 نسخه ۲ — نمایش کل شیء خطا

📘 دیدن جزئیات کامل خطا (name, message, stack):

```js
try {
  let result;
  result = 5 + 2;
  console.log(sum); 
} catch (e) {
  console.log(e);
}
```

🎯 خروجی:

```
ReferenceError: sum is not defined
```

✅ برای برنامه‌نویس خیلی مفید است (دیباگ).

---

### 🔹 نسخه ۳ — فقط پیام خطا (message)

📘 پیام ساده و قابل‌خواندن‌تر:

```js
try {
  let result;
  result = 5 + 2;
  console.log(sum);
} catch (e) {
  console.log(e.message);
}
```

🎯 خروجی:

```
sum is not defined
```

---

### 🔹 نسخه ۴ — فقط نوع خطا (name)

📘 وقتی فقط می‌خوای بدونی خطا از چه نوعیه:

```js
try {
  let result;
  result = 5 + 2;
  console.log(sum);
} catch (e) {
  console.log(e.name);
}
```

🎯 خروجی:

```
ReferenceError
```

🧠 مثال واقعی:

مثل پزشک که فقط نوع بیماری رو می‌پرسه تا نسخه بنویسه 💊

---

### 🔹 نسخه ۵ — پیام سفارشی ترکیبی ✨

📘 ترکیب نام خطا و پیام مخصوص کاربر:

```js
try {
  let result;
  result = 5 + 2;
  console.log(sum);
} catch (e) {
  console.log(`${e.name}: "declare sum first"`);
}
```

🎯 خروجی:

```
ReferenceError: "declare sum first"
```

📖 مثال واقعی:

مثل پیغام خطای باکلاس در برنامه‌ها:

> ⚠️ ReferenceError: لطفاً قبل از استفاده متغیر را تعریف کن!

---

### ✅ بعد از try...catch برنامه متوقف نمی‌شود

حتی بعد از خطا، کد پایین هنوز اجرا می‌شود:

```js
console.log("object");
```

🎯 یعنی تو توانستی خطا را بگیری و برنامه‌ات با خیال راحت ادامه پیدا کند ✨

---

## ✨ نکات مهم از کدت

* همیشه پیام خطا را بخوان تا **ریشهٔ مشکل** را بفهمی.

* سه نوع خطای رایج: **ReferenceError، SyntaxError، TypeError**

* همیشه از `try...catch` برای قسمت‌های حساس استفاده کن.

* `e.name` → نوع خطا

* `e.message` → متن توضیحی خطا

---

## 🧩 آزمون بخش (۱۵ سؤال)

1️⃣ خروجی `console.log(sum)` بدون تعریف sum چیست؟

2️⃣ چه زمانی ReferenceError رخ می‌دهد؟

3️⃣ SyntaxError در چه مرحله‌ای رخ می‌کند؟

4️⃣ چرا `null.sayhello()` باعث TypeError می‌شود؟

5️⃣ خروجی `e.message` چیست؟

6️⃣ خروجی `e.name` چیست؟

7️⃣ تفاوت `try...catch` و اجرای عادی کد چیست؟

8️⃣ در نسخه ۱ چرا اطلاعات دقیق خطا از بین می‌رود؟

9️⃣ در نسخه ۲ چه اطلاعاتی از خطا نمایش داده می‌شود؟

1️⃣0️⃣ در نسخه ۵ چه نوع پیامی نمایش داده می‌شود؟

1️⃣1️⃣ بعد از اجرای catch، آیا برنامه ادامه پیدا می‌کند؟

1️⃣2️⃣ در چه نوع خطایی اصلاً کد اجرا نمی‌شود (قبل از اجرا متوقف می‌شود)؟

1️⃣3️⃣ کدام نسخه فقط پیام خطا را نشان می‌دهد؟

1️⃣4️⃣ کدام نسخه فقط نام خطا را چاپ می‌کند؟

1️⃣5️⃣ در `catch(e)` حرف `e` به چه معناست؟

---

## ✅ پاسخ‌نامهٔ کوتاه

1️⃣ ReferenceError

2️⃣ وقتی متغیر تعریف نشده را استفاده کنیم

3️⃣ هنگام بررسی دستور زبان (قبل از اجرا)

4️⃣ چون null هیچ متدی ندارد

5️⃣ فقط متن توضیح خطا

6️⃣ نوع خطا (مثلاً ReferenceError)

7️⃣ در try...catch خطا گرفته می‌شود و برنامه نمی‌خوابد

8️⃣ چون پیام خطا را با پیام ثابت جایگزین کرده‌ایم

9️⃣ شیء کامل خطا شامل name, message, stack

1️⃣0️⃣ پیام سفارشی همراه با نام خطا

1️⃣1️⃣ بله ✅

1️⃣2️⃣ SyntaxError

1️⃣3️⃣ نسخه ۳

1️⃣4️⃣ نسخه ۴

1️⃣5️⃣ شیء خطا (Error Object)

---

## 🏠 تمرین‌های در خانه (۱۰ تمرین)

1️⃣ کدی بنویس که ReferenceError تولید کند و با try...catch آن را بگیرد.

2️⃣ یک SyntaxError عمداً بساز (مثلاً پرانتز حذف کن) و ببین اجرا متوقف می‌شود.

3️⃣ کدی بنویس که TypeError بدهد و سپس آن را در catch با e.name چاپ کن.

4️⃣ با `e.message` فقط پیام خطا را نمایش بده.

5️⃣ برنامه‌ای بنویس که اگر خطا رخ داد، بنویسد: `"⚠️ خطایی رخ داد، دوباره تلاش کن!"`

6️⃣ داخل catch بررسی کن اگر نوع خطا ReferenceError بود، بنویس `"متغیر تعریف نشده است"`.

7️⃣ با استفاده از نسخه ۵، پیام سفارشی و نوع خطا را با هم چاپ کن.

8️⃣ بعد از catch دستور console.log("Done!") بگذار تا ببینی برنامه متوقف نمی‌شود.

9️⃣ یک برنامه بنویس که دو عدد را تقسیم کند و اگر مخرج صفر بود، خطای سفارشی بده.

1️⃣0️⃣ یک مثال واقعی از زندگی بیاور که به مفهوم try...catch شبیه باشد (مثلاً فیوز برق، کمربند ایمنی و ...).

---

## 🗒️ Cheat-Sheet (خلاصه تقلبی)

| مفهوم            | توضیح کوتاه                 | مثال                             |
| ---------------- | --------------------------- | -------------------------------- |
| `ReferenceError` | متغیر تعریف‌نشده            | `console.log(x)`                 |
| `SyntaxError`    | اشتباه در نحو زبان          | `if 5<10 {}`                     |
| `TypeError`      | عملیات نامعتبر روی نوع داده | `null.sayHello()`                |
| `try...catch`    | گرفتن و کنترل خطا           | `try {...} catch(e){...}`        |
| `e.name`         | نوع خطا                     | `"ReferenceError"`               |
| `e.message`      | پیام خطا                    | `"x is not defined"`             |
| نسخه ۱           | پیام ثابت                   | `"try again"`                    |
| نسخه ۲           | نمایش شیء خطا               | `console.log(e)`                 |
| نسخه ۳           | فقط پیام خطا                | `e.message`                      |
| نسخه ۴           | فقط نوع خطا                 | `e.name`                         |
| نسخه ۵           | پیام سفارشی با نوع          | `${e.name}: "declare sum first"` |

---
